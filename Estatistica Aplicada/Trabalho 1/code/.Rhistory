library(haven)
library(dplyr)
library(magrittr)
library(ggplot2)
library(gridExtra)
library(tidyr)
library(ggpubr)
install.packages("ggpubr")
library(ggpubr)
library(purrr)
library(flextable)
install.packages("flextable")
install.packages("xtable")
library(xtable)
library(haven)
library(dplyr)
library(magrittr)
library(purrr)
library(tidyr)
library(stringr)
# Importacao base de dados
base <-
read_sav("../data/BancoTeseCris_09_07_2013.sav") %>%
mutate(
Sexo = factor(Sexo, labels = c("Homem", "Mulher"))
)
setwd("~/UFF/commit/uff/Estatistica Aplicada/Trabalho 1/code")
# Importacao base de dados
base <-
read_sav("../data/BancoTeseCris_09_07_2013.sav") %>%
mutate(
Sexo = factor(Sexo, labels = c("Homem", "Mulher"))
)
base_pew <-
base %>%
select(
Sexo, Idade,
PEW_ANTES, PEW_APOS
) %>%
na.omit() %>%
# Perda no PEW (2 = teve perda)
mutate(
PEW_ANTES = factor(PEW_ANTES, labels = c("Não", "Sim")),
PEW_APOS = factor(PEW_APOS, labels = c("Não", "Sim"))
)
mc_test <- base_pew %>% select(PEW_ANTES, PEW_APOS) %>% table() %>% mcnemar.test()
df_tabela_pew <-
base_pew %>%
cbind("marcador" = "PEW") %>%
select(marcador, PEW_ANTES, PEW_APOS) %>%
mutate_at(2:3, ~ if_else(.x == "Não", 0, 1)) %>%
group_by(marcador) %>%
summarise(
# Antes
# Sem presença de perda
# Com presença de perda
"sem_pres_de_perda_antes" = length(PEW_ANTES)-sum(PEW_ANTES),
"com_pres_de_perda_antes" = sum(PEW_ANTES),
# Depois
"sem_pres_de_perda_apos" = length(PEW_APOS)-sum(PEW_APOS),
"com_pres_de_perda_apos" = sum(PEW_APOS),
n = length(PEW_ANTES)
) %>%
bind_cols(
mc_test$p.value %>%
as.data.frame %>%
round(3) %>%
`colnames<-`("p_valor") %>%
mutate(p_valor = ifelse(p_valor < 0.001, "<0.001", p_valor) %>% str_replace("\\.", ","))
)
typology_tabela <-
data.frame(
col_keys = c("marcador","sem_pres_de_perda_antes","com_pres_de_perda_antes","sem_pres_de_perda_apos","com_pres_de_perda_apos","n","p_valor"),
type = c("", "Presença de perda \n antes do RETP", "Presença de perda \n antes do RETP", "Presença de perda \n depois do RETP", "Presença de perda \n depois do RETP", "", " "),
what = c("Marcador","Apresentou perda","Não apresentou perda","Apresentou perda","Não apresentou perda","Tamanho da amostra","P-valor \n (Teste de McNemar)"),
stringsAsFactors = FALSE
)
df_tabela_pew
df_tabela_pew %>% xtable()
